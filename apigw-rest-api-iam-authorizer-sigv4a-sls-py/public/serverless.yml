service: serverless-land-${self:custom.name}-public

frameworkVersion: '3'

provider:
  name: aws
  runtime: python3.12

  iam:
    role:
      statements:
        - Effect: Allow
          Action: execute-api:Invoke
          Resource: !Sub arn:aws:execute-api:${AWS::Region}:${AWS::AccountId}:${param:PrivateApiGatewayRestApi}/${sls:stage}/GET/private

custom:
  name: bb245
  logRetentionInDays: 1

plugins:
  - serverless-python-requirements
  - serverless-plugin-log-retention

functions:
  get-public:
    handler: app.handler
    events:
      - http:
          path: /public
          method: get
    environment:
      aws_iam_secured_service_url: '${param:PrivateApiEndpoint}'

resources:
  Outputs:
    PublicApiEndpoint:
      Value: !Sub 'https://${ApiGatewayRestApi}.execute-api.${aws:region}.amazonaws.com/${sls:stage}/public'