{
    "title": "Amazon GuardDuty Malware Protection for Amazon S3",
    "description": "Configure Malware Protection for Amazon S3 bucket using Amazon GuardDuty",
    "language": "YAML",
    "level": "200",
    "framework": "AWS SAM",
    "introBox": {
        "headline": "How it works",
        "text": [
            "This pattern demonstrates creating an Amazon S3 Malware Protection plan and integrating the findings with Amazon EventBridge and Amazon SNS to notify users of the scan results.",
            "The AWS SAM template creates an IAM role that includes permissions required for GuardDuty to receive S3 put object and bucket-level event notifications through an EventBridge managed rule. The template also creates an EventBridge managed rule, which is used to route S3 `put-object` and S3 bucket-level event notifications to GuardDuty's S3 Malware Protection Service.",
            "Another EventBridge rule monitors the S3 object scan results and sends notifications to an SNS topic where users can subscribe via email.",
            "This pattern deploys one S3 Bucket, one SNS topic, one SNS subscription, one IAM role, one EventBridge rule, and one Malware protection plan."
        ]
    },
    "gitHub": {
        "template": {
            "repoURL": "https://github.com/aws-samples/serverless-patterns/tree/main/guardduty-malware-s3",
            "templateURL": "serverless-patterns/guardduty-malware-s3",
            "projectFolder": "guardduty-malware-s3",
            "templateFile": "template.yaml"
        }
    },
    "resources": {
        "bullets": [
            {
                "text": "GuardDuty Malware Protection for S3",
                "link": "https://docs.aws.amazon.com/guardduty/latest/ug/gdu-malware-protection-s3.html"
            },
            {
                "text": "Introducing Amazon GuardDuty Malware Protection for Amazon S3",
                "link": "https://aws.amazon.com/blogs/aws/introducing-amazon-guardduty-malware-protection-for-amazon-s3/"
            }
        ]
    },
    "deploy": {
        "text": [
            "sam deploy --guided"
        ]
    },
    "testing": {
        "text": [
            "See the GitHub repo for detailed testing instructions."
        ]
    },
    "cleanup": {
        "text": [
            "Delete the stack: <code>sam delete</code>."
        ]
    },
    "authors": [
        {
            "name": "Sumit Kapoor",
            "image": "./sumit.jpg",
            "bio": "I am currently working as a Lead DevOps Engineer at Clarivate",
            "linkedin": "sumit-kapoor-61574839",
            "twitter": ""
        }
    ],
    "patternArch": {
        "icon1": {
            "x": 10,
            "y": 50,
            "service": "s3",
            "label": "Amazon S3"
        },
        "icon2": {
            "x": 35,
            "y": 50,
            "service": "eventbridge",
            "label": "Amazon EventBridge"
        },
        "icon3": {
            "x": 65,
            "y": 50,
            "service": "guard-duty",
            "label": "Amazon GuardDuty"
        },
        "icon5": {
            "x": 90,
            "y": 50,
            "service": "sns",
            "label": "Amazon SNS"
        },
        "line1": {
            "from": "icon1",
            "to": "icon2"
        },
        "line2": {
            "from": "icon2",
            "to": "icon3"
        },
        "line3": {
            "from": "icon3",
            "to": "icon5"
        }
    }
}
